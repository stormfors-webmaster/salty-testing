(()=>{function B(g){console.log(`%c\u{1F6E0}\uFE0F ${g} Dev Mode Active`,"color: #2ecc71; font-weight: bold; font-size: 14px;")}function W(){console.log("map.js module loaded");let g="pk.eyJ1IjoiZmVsaXhoZWxsc3Ryb20iLCJhIjoiY20zaXhucjcwMDVwdTJqcG83ZjMxemJlciJ9._TipZd1k8nMEslWbCDg6Eg",t=9,i=[-118.37655405160609,33.78915439099377],n=0;mapboxgl.accessToken=g;let o=new mapboxgl.Map({container:"map",style:"mapbox://styles/cv-mapbox/cm5zh2w0i002g01sfdcrs6dgj",projection:"globe",zoom:t,center:i,pitch:n});o.addControl(new mapboxgl.NavigationControl,"bottom-right"),o.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0}),"bottom-right"),window.dev={openHome:v,closeHome:x,openBeachList:f,closeBeachList:y,openBeach:I,closeBeach:b,openShop:D};let a=new Map;s();async function s(){d(),h(),window.location.search.includes("beaches")&&(console.log("beaches query found"),x(),f(),window.history.pushState({},"",window.location.pathname)),window.innerWidth<=991&&$(".mapboxgl-ctrl-bottom-right").hide()}function h(){document.querySelectorAll("[temp-data=beach]").forEach(r=>{let p=r.getAttribute("temp-id"),l=parseFloat(r.getAttribute("lat")),m=parseFloat(r.getAttribute("lon"));if(isNaN(l)||isNaN(m)||l<-90||l>90||m<-180||m>180){console.warn(`Invalid coordinates for beach ${p}: lat=${l}, lon=${m}`);return}let E=[m,l],C=r.getAttribute("popup-text");c(E,C,p)})}function c(e,r,p){let l=new mapboxgl.Popup({offset:25}).setText(r),m=document.createElement("div");m.className="beach-marker",m.id=p;let E=new mapboxgl.Marker(m).setLngLat(e).setPopup(l).addTo(o);a.set(p,E),l.on("open",()=>{let C=l.getLngLat().lng,N=l.getLngLat().lat;console.log("popup opened"),console.log(p),o.flyTo({center:[C,N],zoom:14,pitch:75}),S(),f(),I(p),window.scrollTo({top:0,behavior:"instant"})}),l.on("close",()=>{console.log("popup closed"),console.log(p),window.scrollTo({top:0,behavior:"instant"})})}function d(){document.addEventListener("click",e=>{if(e.target.matches("[open-sidebar=home], [open-sidebar=home] *")&&(e.preventDefault(),S(),v(),A()),e.target.matches("[open-sidebar=beach-list], [open-sidebar=beach-list] *")&&(e.preventDefault(),S(),window.innerWidth>479&&f(),window.innerWidth<=991&&T(),window.innerWidth<=479&&f()),e.target.matches("[map-link=item], [map-link=item] *")){let r=e.target.matches("[map-link=item]")?e.target:e.target.closest("[map-link=item]"),p=r.getAttribute("lat"),l=r.getAttribute("lon"),m=r.getAttribute("temp-id");H(m),o.flyTo({center:[l,p],zoom:14,pitch:75}),I(m)}if(e.target.matches(".modal_close-button, .modal_close-button *, .mobile-back, .mobile-back *")&&b(),e.target.matches("[close-sidebar=beach]")&&(q(),f()),e.target.matches("[map-function=expand]")&&(T(),setTimeout(()=>{$("[sidebar-toggle=beach-list]").show(),$(".mapboxgl-ctrl-bottom-right").show()},1e3)),e.target.matches("[map-function=collapse] *, [map-function=collapse]")&&(X(),$("[sidebar=beach-list]").css({transform:"translateX(-100%)",transition:"none"}),$("[sidebar=home]").css({transform:"translateX(0%)",transition:"none"}),$("[sidebar-toggle=beach-list]").hide(),$(".mapboxgl-ctrl-bottom-right").hide()),e.target.matches("[toggle-sidebar=home]")&&z(),e.target.matches("[toggle-sidebar=beach-list]")&&L(),e.target.matches(".mob-beach-top-inner, .mob-beach-top-inner *")&&(console.log("mob-beach-top-inner clicked"),b(),f()),e.target.matches("[stormfors-sort=reverse]")){let r=document.querySelector(".beach-list_list"),p=[...r.children];p.reverse(),p.forEach(l=>r.appendChild(l))}})}function z(){$("[sidebar-toggle=home]").hasClass("folded")?v():x()}function L(){$("[sidebar-toggle=beach-list]").hasClass("folded")?f():(y(),b())}function T(){$("[map-function=expand]").hide(),$("[map-function=container]").addClass("expanded");for(let e=0;e<100;e++)setTimeout(()=>{o.resize()},e*10);o.resize(),setTimeout(()=>{o.resize(),$("[map-function=collapse]").show()},1e3)}function X(){$("[map-function=collapse]").hide(),$("[map-function=container]").removeClass("expanded");for(let e=0;e<100;e++)setTimeout(()=>{o.resize()},e*10);setTimeout(()=>{$("[map-function=expand]").show()},1e3)}function D(){window.scrollTo({top:0,behavior:"instant"}),$("[page=shop]").removeClass("hide")}function j(){window.scrollTo({top:0,behavior:"instant"}),$("[page=shop]").addClass("hide")}function v(){window.scrollTo({top:0,behavior:"instant"}),$("[sidebar=home]").removeClass("folded"),$("[sidebar-toggle=home]").removeClass("folded"),setTimeout(()=>{$("[map-function=expand]").show(),$("[home-toggle-icon=when-open]").show(),$("[home-toggle-icon=when-closed]").hide()},500)}function x(){window.scrollTo({top:0,behavior:"instant"}),$("[sidebar=home]").addClass("folded"),$("[sidebar-toggle=home]").addClass("folded"),$("[home-toggle-icon=when-open]").hide(),$("[home-toggle-icon=when-closed]").show()}function f(){window.scrollTo({top:0,behavior:"instant"}),window.innerWidth<=479&&$("[sidebar=beach-list]").css({transition:"none",transform:"translateX(0%)"}),$("[sidebar-toggle=beach-list]").removeClass("folded"),$("[sidebar=beach-list]").removeClass("folded"),$("[beach-toggle-icon=when-open]").show(),$("[beach-toggle-icon=when-closed]").hide()}function y(){window.scrollTo({top:0,behavior:"instant"}),$("[sidebar-toggle=beach-list]").addClass("folded"),$("[sidebar=beach-list]").addClass("folded"),$("[beach-toggle-icon=when-open]").hide(),$("[beach-toggle-icon=when-closed]").show()}function I(e){window.scrollTo({top:0,behavior:"instant"}),window.innerWidth<=479&&$("[sidebar=beach-list]").css({transition:"none",transform:"translateX(-100%)"}),$("[sidebar=beach]").show(),$("[sidebar="+e+"]").show(),$("[sidebar="+e+"]").parent().show()}function b(e){window.scrollTo({top:0,behavior:"instant"}),$("[sidebar=beach]").hide(),$("[sidebar="+e+"]").hide(),$("[sidebar="+e+"]").parent().hide()}function S(){window.history.pushState({},"",window.location.pathname),window.scrollTo({top:0,behavior:"instant"}),x(),y(),b(),$("[beach-item=container]").hide()}function A(){o.flyTo({center:i,zoom:t,pitch:n})}function U(){let e=o.getCenter();console.log(`Map center: ${e.lng}, ${e.lat}`)}function V(){let e=o.getZoom();console.log(`Map zoom level: ${e}`)}function F(){let e=o.getPitch();console.log(`Map pitch: ${e}`)}function J(){o.on("moveend",()=>{U(),V(),F()}),o.on("click",e=>{console.log(`${e.lngLat.lng}, ${e.lngLat.lat}`),console.log(e)})}function H(e){let r=a.get(e);r&&r.togglePopup()}function q(){a.forEach(e=>{let r=e.getPopup();r.isOpen()&&r.remove()})}}var w=class{constructor(t){this.container=t,this.svg=t.querySelector(".notch-svg"),this.path=t.querySelector(".dynamic-path"),this.notchButton=t.querySelector(".card_button"),this.rightEdge=304,this.points=[],this.controlPoints=[],this.bezierRelationships=[],this.originalPoints=[],this.originalControlPoints=[],this.initialize()}initialize(){let t=this.initializePath();this.setupResizeObserver()}initializePath(){let t=this.path.getAttribute("d").trim().split(/(?=[MmLlHhVvCcSsQqTtAaZz])/),i=0,n=0;return t.forEach(o=>{let a=o[0],s=o.slice(1).trim().split(/[\s,]+/).map(Number);switch(a){case"M":case"L":this.points.push({type:a,x:s[0],y:s[1]}),i++;break;case"C":this.controlPoints.push({x:s[0],y:s[1]},{x:s[2],y:s[3]}),this.points.push({type:a,x:s[4],y:s[5]}),this.bezierRelationships.push({pointIndex:i,controlPoints:[n,n+1]}),n+=2,i++;break}}),this.originalPoints=this.points.map(o=>({...o})),this.originalControlPoints=this.controlPoints.map(o=>({...o})),t}updatePath(){let t="",i=0,n=0;this.path.getAttribute("d").trim().split(/(?=[MmLlHhVvCcSsQqTtAaZz])/).forEach(a=>{let s=a[0];switch(s){case"M":case"L":t+=`${s}${this.points[i].x} ${this.points[i].y} `,i++;break;case"C":let h=this.controlPoints[n],c=this.controlPoints[n+1],d=this.points[i];t+=`${s}${h.x} ${h.y} ${c.x} ${c.y} ${d.x} ${d.y} `,n+=2,i++;break;default:t+=a+" "}}),this.path.setAttribute("d",t.trim())}updateNotchWidth(t){let i=t/this.notchButton.parentElement.offsetWidth*this.rightEdge,n=this.rightEdge-i,o=130;for(let a=7;a<=12;a++){let s=this.points[a].x;this.points[a].x=n+(this.originalPoints[a].x-(this.rightEdge-o));let h=this.bezierRelationships.find(c=>c.pointIndex===a);if(h){let[c,d]=h.controlPoints;this.controlPoints[c].x=n+(this.originalControlPoints[c].x-(this.rightEdge-o)),this.controlPoints[d].x=n+(this.originalControlPoints[d].x-(this.rightEdge-o))}}this.updatePath()}setupResizeObserver(){new ResizeObserver(i=>{for(let n of i)this.updateNotchWidth(n.contentRect.width)}).observe(this.notchButton)}};var u=class{constructor(t){if(this.containerId=t.containerId,this.prevBtnId=t.prevBtnId,this.nextBtnId=t.nextBtnId,this.stepSize=t.stepSize||1,this.maxItems=t.maxItems||null,this.itemWidth=t.itemWidth||"22rem",this.categoryUrl=t.categoryUrl||"#",this.container=document.getElementById(this.containerId),this.prevBtn=document.getElementById(this.prevBtnId),this.nextBtn=document.getElementById(this.nextBtnId),!this.container||!this.prevBtn||!this.nextBtn)return;this.items=Array.from(this.container.children),this.maxItems&&this.items.length>this.maxItems&&(this.items=this.items.slice(0,this.maxItems),Array.from(this.container.children).slice(this.maxItems).forEach(c=>c.style.display="none"));let i=document.createElement("a");i.href=this.categoryUrl,i.classList.add("slider-last-card"),i.innerHTML="<h6>Go to Category</h6>";let n=document.createElement("div");n.appendChild(i),this.container.appendChild(n),this.items.push(n);let o=this.container.offsetWidth,a=parseFloat(this.itemWidth),s=this.itemWidth.replace(a.toString(),""),h;if(s==="rem")h=a*parseFloat(getComputedStyle(document.documentElement).fontSize);else if(s==="px")h=a;else{let c=document.createElement("div");c.style.width=this.itemWidth,document.body.appendChild(c),h=c.offsetWidth,document.body.removeChild(c)}if(this.itemsInView=Math.floor(o/h),this.items.length<=this.itemsInView){console.warn("Not enough items to create slider");return}this.currentIndex=0,this.touchStartX=0,this.touchEndX=0,this.currentTranslateX=0,this.isDragging=!1,this.startTranslateX=0,this.init()}init(){this.container.style.display="flex",this.container.style.overflow="visible",this.container.style.position="relative",this.container.style.userSelect="none",this.items.forEach((t,i)=>{if(t.style.flex=`0 0 ${this.itemWidth}`,t.style.transition="transform 0.3s ease-in-out",i===this.items.length-1){let n=t.querySelector("a");n&&(n.style.width="100%",n.style.margin="0rem")}}),this.prevBtn.addEventListener("click",t=>{t.preventDefault(),this.slide("prev")}),this.nextBtn.addEventListener("click",t=>{t.preventDefault(),this.slide("next")}),this.container.addEventListener("touchstart",t=>this.handleTouchStart(t)),this.container.addEventListener("touchmove",t=>this.handleTouchMove(t)),this.container.addEventListener("touchend",()=>this.handleTouchEnd()),this.updateButtonStates()}slide(t){t==="next"&&this.currentIndex<this.items.length-this.itemsInView?this.currentIndex=Math.min(this.currentIndex+this.stepSize,this.items.length-this.itemsInView):t==="prev"&&this.currentIndex>0&&(this.currentIndex=Math.max(0,this.currentIndex-this.stepSize)),this.updateSliderPosition(),this.updateButtonStates()}updateSliderPosition(){let t=parseFloat(this.itemWidth),i=this.itemWidth.replace(t.toString(),""),n;if(i==="rem")n=-(this.currentIndex*t*parseFloat(getComputedStyle(document.documentElement).fontSize));else if(i==="px")n=-(this.currentIndex*t);else{let o=document.createElement("div");o.style.width=this.itemWidth,document.body.appendChild(o),n=-(this.currentIndex*o.offsetWidth),document.body.removeChild(o)}this.currentTranslateX=n,this.items.forEach(o=>{o.style.transform=`translateX(${n}px)`})}updateButtonStates(){let t=this.currentIndex===0,i=this.currentIndex>=this.items.length-this.itemsInView;this.prevBtn.disabled=t,this.nextBtn.disabled=i,this.prevBtn.style.opacity=t?"0.3":"1",this.nextBtn.style.opacity=i?"0.3":"1"}handleTouchStart(t){this.isDragging=!0,this.touchStartX=t.touches[0].clientX,this.startTranslateX=this.currentTranslateX,this.items.forEach(i=>{i.style.transition="none"})}handleTouchMove(t){if(!this.isDragging)return;t.preventDefault(),this.touchEndX=t.touches[0].clientX;let i=this.touchEndX-this.touchStartX,n=this.startTranslateX+i,o=parseFloat(this.itemWidth),a=this.itemWidth.replace(o.toString(),""),s;if(a==="rem")s=o*parseFloat(getComputedStyle(document.documentElement).fontSize);else if(a==="px")s=o;else{let d=document.createElement("div");d.style.width=this.itemWidth,document.body.appendChild(d),s=d.offsetWidth,document.body.removeChild(d)}let h=0,c=-((this.items.length-this.itemsInView)*s);this.currentTranslateX=Math.max(c,Math.min(h,n)),this.items.forEach(d=>{d.style.transform=`translateX(${this.currentTranslateX}px)`})}handleTouchEnd(){if(!this.isDragging)return;this.isDragging=!1;let t=parseFloat(this.itemWidth),i=this.itemWidth.replace(t.toString(),""),n;if(i==="rem")n=t*parseFloat(getComputedStyle(document.documentElement).fontSize);else if(i==="px")n=t;else{let s=document.createElement("div");s.style.width=this.itemWidth,document.body.appendChild(s),n=s.offsetWidth,document.body.removeChild(s)}let o=Math.round(-this.currentTranslateX/(n/2)),a=Math.floor(-this.currentTranslateX/n);this.currentIndex=Math.max(0,Math.min(this.items.length-this.itemsInView,a)),this.items.forEach(s=>{s.style.transition="transform 0.3s ease-in-out"}),this.updateSliderPosition(),this.updateButtonStates()}};var O=localStorage.getItem("devMode")==="true";O&&B("Salty App");var M=window.location.pathname==="/",P=window.location.pathname.includes("/store");!M&&!P&&console.log("no script");M&&R();P&&Z();function k(){if(window.innerWidth>479){document.querySelectorAll(".path-container").forEach(t=>{new w(t)});return}}async function R(){console.log("init homepage"),W(),k();let g=new u({containerId:"slider-kiddos",prevBtnId:"prev-button-kiddos",nextBtnId:"next-button-kiddos",itemWidth:"22rem",stepSize:1,maxItems:10,categoryUrl:"/product-categories/kiddos"}),t=new u({containerId:"slider-sun",prevBtnId:"prev-button-sun",nextBtnId:"next-button-sun",itemWidth:"22rem",stepSize:1,maxItems:10,categoryUrl:"/product-categories/sun-protection"}),i=new u({containerId:"slider-transport",prevBtnId:"prev-button-transport",nextBtnId:"next-button-transport",itemWidth:"22rem",stepSize:1,maxItems:10,categoryUrl:"/product-categories/transport"})}function Z(){console.log("init store"),k();let g=new u({containerId:"slider-kiddos",prevBtnId:"prev-button-kiddos",nextBtnId:"next-button-kiddos",itemWidth:"22rem",stepSize:1,maxItems:10,categoryUrl:"/product-categories/kiddos"}),t=new u({containerId:"slider-sun",prevBtnId:"prev-button-sun",nextBtnId:"next-button-sun",itemWidth:"22rem",stepSize:1,maxItems:10,categoryUrl:"/product-categories/sun-protection"}),i=new u({containerId:"slider-transport",prevBtnId:"prev-button-transport",nextBtnId:"next-button-transport",itemWidth:"22rem",stepSize:1,maxItems:10,categoryUrl:"/product-categories/transport"})}})();
